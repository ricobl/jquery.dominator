<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<script src="assets/jquery-1.4.2.min.js"></script>
<link rel="stylesheet" href="assets/qunit.css" type="text/css" media="screen" />
<script type="text/javascript" src="assets/qunit.js"></script>
<script>
(function($){
    var dominator = function (selector) {
        /* Generates markup using CSS selectors */
        var parts = selector.split(' ').reverse();
        var element = null;
        $.each(parts, function(){
            var parsed = $.dominator.parseSelector(this);
            var part = $('<' + parsed.tag + ' />');
            part.attr(parsed.attrs);
            if (element) {
                part.append(element);
            }
            element = part;
        });
        return element;
    };
    $.extend(dominator, {
        parseSelector: function (selector) {
            /* Returns structured data from a simple selector */
            var parts = selector.split('#');
            var parsed = {attrs: {}};
            if (parts.length == 2) {
                parsed.attrs.id = parts[1];
            }
            parsed.tag = parts.length ? parts[0] : 'div';
            return parsed;
        }
    });

    $.extend({dominator: dominator});
})(jQuery);
</script>
<script>
$(document).ready(function(){
    module('dominator');

    function html (element) {
        return $('<div />').append(element).html();
    }

    test('generate simple tag', function() {
        expect(2);
        equals(html($.dominator('p')), '<p></p>', '"p" generates a p');
        equals(html($.dominator('div')), '<div></div>', '"div" generates a div');
    });

    test('generate nested tags', function() {
        expect(2);
        equals(html($.dominator('div p')), '<div><p></p></div>', '"div p" selector generates div/p');
        equals(html($.dominator('div p span a')), '<div><p><span><a></a></span></p></div>', '"div p span a" selector generates div/p/span/a');
    });

    test('generate with id', function() {
        equals(html($.dominator('div#myid')), '<div id="myid"></div>', '"div#myid" generates a div[id=myid]');
    });

    test('generate simple tag with nested id', function() {
        equals(html($.dominator('div p#myid')), '<div><p id="myid"></p></div>', '"div p#myid" generates a div/p[id=myid]');
    });
});
</script>
</head>
<body>
    <h1 id="qunit-header">QUnit example</h1>
    <h2 id="qunit-banner"></h2>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
</body>
</html>
